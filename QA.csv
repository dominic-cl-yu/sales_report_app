"问题","回答"
"1. 为什么要把这个工具部署到 Azure Container？本地跑 Python 不就行了？","Azure Container Apps（或 Azure Web App for Containers）提供 7×24 小时稳定访问、全公司任意地点都能用、无需每个人安装环境。内部工具最适合这种轻量云部署，既方便又可控，成本极低。"
"2. 部署到云上安全吗？上传的销售订单文件包含敏感数据。","文件仅在内存处理，不落地存储；处理完立即释放。部署时可放在公司 VNet 内、启用 Private Endpoint，只允许公司 IP 访问；也可快速加上 Azure AD 认证，确保只有授权人员能打开页面。"
"3. Hugging Face Token 直接写在 .env 里，部署到容器会不会泄露？","不会硬编码。我们会把 HF_TOKEN 放入 Azure Key Vault 或 Container Apps 的 Secret 管理，容器启动时动态注入环境变量，镜像本身不含任何密钥。"
"4. 如果多人同时上传大文件，会不会把容器内存打爆？","Streamlit file_uploader 已限制最大 200MB（可配置）；pandas 处理 Excel 高效，实测 50MB 文件只需约 1-2GB 内存。Container Apps 支持自动扩容到更高内存规格，极端情况也会超时返回友好提示，不会崩溃。"
"5. Streamlit 是不是只适合原型？生产环境可靠吗？","很多企业（包括 Fortune 500）用 Streamlit 部署内部工具和 dashboard。配合 Azure 的监控、自动重启、健康检查，完全可以达到生产级可靠性。我们流量很低，更不成问题。"
"6. Azure 运行要花多少钱？","按实际使用计费。低流量下 Container Apps 每月大概 10-30 USD（视内存规格），远低于维护一台常开服务器的成本。我们可以开启自动暂停（无请求时 0 费用）。"
"7. 为什么 Team 分类还要用 LLM？规则映射不就够了？","规则已经覆盖 95%+ 的情况，只有极少数新出现或写法奇怪的 Team 才会 fallback 到 LLM（Hugging Face Inference API）。这样保证分类永远准确，且调用次数极少，月成本几乎为 0。"
"8. 如果 LLM 服务挂了或超限，会影响报表生成吗？","不会。代码设计是「规则优先，LLM 仅备用」。即使 Hugging Face 完全不可用，也只会保留原始 Team 名称，不阻塞主流程。"
"9. 报表里的 Total 行现在用 SUBTOTAL(109,...) 公式，筛选时会自动更新吗？","是的，这是我们专门修复的重点。所有 Total 行都使用 SUBTOTAL(109, range)，在 Excel 中筛选、隐藏行时会实时更新，完全满足端用户需求。"
"10. 为什么不直接用 Power BI 或现有 BI 工具？","现有工具需要手动清洗、映射 Team、处理多 sheet、补齐缺失月份等繁琐步骤。这个工具一键自动化完成，节省每个人每周数小时，且输出格式完全符合销售团队习惯。"
"11. 如何保证每次生成的报表格式完全一致？","核心逻辑全部在 process.py 中，输出使用 openpyxl 精确控制标题、列宽、表格样式、公式。每次运行在相同输入下输出字节级一致，已通过多轮测试验证。"
"12. 如果源 Excel 格式又变了（比如列名改了），工具会不会坏？","表头检测支持多种别名和模糊匹配，历史文件全部兼容。新列名只要包含关键词（如 'qty'、'delivery date'）就能自动识别。必要时只需加一行别名配置，无需改代码。"
"13. 我们有 .xls 老文件，部署后还能处理吗？","支持。代码已处理 .xls（xlrd）和 .xlsx（openpyxl）两种格式，镜像里会包含必要依赖。"
"14. 部署后怎么更新代码？","使用 GitHub Actions + Azure Container Registry 自动构建镜像，推到 ACR 后一键更新 Container Apps。更新过程零宕机（蓝绿部署）。"
"15. 需要做容灾或备份吗？","应用本身无状态，不存储任何数据。代码和镜像都在 Git + ACR，有完整版本历史。报表由用户自行下载保存，无需服务器备份。"
"16. 如何监控使用情况和错误？","Azure Monitor 自动收集容器日志、请求数、CPU/内存、错误堆栈。我们还能在代码里加 Application Insights，关键错误会推送 Teams 通知。"
"17. 用户上传错误格式的文件会怎样？","代码有完整异常捕获，会返回清晰中文错误提示（如「未找到表头」「缺少必要列」「无有效数据」），不会崩溃或返回空白文件。"
"18. 报表里 Customer 固定写 ALL，可不可以改？","可以。常量 CUSTOMER_LABEL_DEFAULT 在 process.py 顶部，只要改一行即可全量生效，重新部署即可。"
"19. 为什么不用 Docker Compose 本地多容器？","单容器足够，轻量快速。所有依赖都在一个镜像里，部署、管理、监控最简单。"
"20. 手机或平板能用吗？","Streamlit 自适应响应式布局，在手机浏览器上也可以上传文件、生成、下载报表，体验良好。"
"21. 有没有做性能测试？","实测：50MB 多 sheet 文件（约 4 万行）整个流程 ≤ 15 秒；10MB 文件 ≤ 5 秒。完全满足日常使用。"
"22. 如果 Azure 区域故障怎么办？","可一键把 Container Apps 部署到另一个区域（镜像已在 ACR 全球同步），切换只需几分钟。"
"23. 依赖库有漏洞怎么办？","每周自动运行 Dependabot + GitHub Actions 扫描，发现高危漏洞立即通知并升级。当前所有依赖均为最新稳定版。"
"24. 为什么不直接给用户 .py 脚本让他们自己跑？","非技术人员不会配置环境、安装依赖、处理路径问题。Web 界面一键上传下载，极大降低使用门槛。"
"25. 生成的报表有 Grand Total 吗？","按最新需求，每张子表只有自己的 Total 行，没有跨产品类型的 Grand Total，保持清晰且筛选友好。"
"26. 月份列会自动补齐缺失月份吗？","是的。代码会找出所有 Customer Delivery Date 的最早和最晚月份，自动填充中间所有月份（即使该月为 0），并全局去除前后全是 0 的列。"
"27. Order Type 的 FR 会显示成 Forecast-FR 吗？","是的，代码中专门映射显示为 'Forecast-FR'，便于阅读，同时内部仍保留原始值。"
"28. 部署后如何限制同时运行人数？","如果需要，可在 Container Apps 设置最大实例数，或在代码层加简单队列（session 计数），但目前内部使用量无需限制。"
"29. 为什么选择 Azure Container Apps 而不是 Virtual Machine？","容器启动快、按秒计费、自动扩缩容、管理负担最低。VM 需要打补丁、重启、维护，性价比低。"
"30. 如果领导问「这个工具真的必要吗？」怎么回答？","它把原来需要 1-2 小时手动清洗、透视、补公式的工作压缩到 10 秒，一键生成标准格式报表。每周为销售团队节省数十小时，提升数据准确性，已获得多位端用户正面反馈，完全值得上线。"